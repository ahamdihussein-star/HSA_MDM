<!-- Floating Chat Widget -->
<div class="chat-widget-container">
  <!-- Toggle Button -->
  <button 
    class="chat-toggle-button" 
    (click)="toggleChat()"
    *ngIf="!isOpen"
    nz-tooltip
    nzTooltipTitle="Data Entry AI Assistant"
    nzTooltipPlacement="left">
    <span aria-hidden="true">๐ค</span>
  </button>

  <!-- Chat Window -->
  <div class="chat-window" *ngIf="isOpen">
    <!-- Header -->
    <div class="chat-header">
      <div class="header-content">
        <h3>๐ค Data Entry AI Assistant</h3>
        <p class="user-greeting">{{ getCurrentUserName() }}</p>
      </div>
      <div class="header-actions">
        <button 
          class="minimize-btn" 
          (click)="minimizeChat()"
          nz-tooltip
          nzTooltipTitle="Minimize">
          <span aria-hidden="true">โ</span>
        </button>
        <button 
          class="close-btn" 
          (click)="closeChat()"
          nz-tooltip
          nzTooltipTitle="Close">
          <span aria-hidden="true">ร</span>
        </button>
      </div>
    </div>

    <!-- Chat Body -->
    <div class="chat-body">
      <!-- Messages -->
      <div class="messages-container">
        <div 
          *ngFor="let message of messages" 
          class="message"
          [attr.data-message-id]="message.id"
          [attr.data-message-type]="message.type"
          [ngClass]="{'user-message': message.role === 'user', 'assistant-message': message.role === 'assistant'}">
          
          <!-- Text Messages -->
          <div *ngIf="message.type === 'text'" [innerHTML]="formatMessage(message.content)"></div>

          <!-- Actions (Quick Buttons) -->
          <ng-container *ngIf="message.type === 'actions'">
            <div class="action-buttons">
              <div class="action-title" [innerHTML]="formatMessage(message.content)"></div>
              <button 
                *ngFor="let btn of message.data?.buttons" 
                class="action-btn"
                (click)="onButtonClick(btn.action, btn.data)"
                [innerHTML]="btn.text">
              </button>
            </div>
          </ng-container>

          <!-- Confirmation Messages -->
          <div *ngIf="message.type === 'confirmation'" class="confirmation-message">
            <div [innerHTML]="formatMessage(message.content)"></div>
            <div *ngIf="message.data?.buttons" class="confirmation-buttons">
              <button 
                *ngFor="let btn of message.data.buttons" 
                class="confirmation-btn"
                (click)="onButtonClick(btn.action, btn.data)"
                [innerHTML]="btn.text">
              </button>
            </div>
          </div>
          
          <!-- Loading Messages -->
          <div *ngIf="message.type === 'loading'" class="loading-message">
            <i nz-icon nzType="loading" nzTheme="outline"></i>
            {{ message.content }}
          </div>
          
          <!-- Progress Messages -->
          <div *ngIf="message.type === 'progress'" class="progress-message">
            <nz-progress [nzPercent]="extractionProgress" [nzShowInfo]="false"></nz-progress>
            <p>{{ message.content }}</p>
          </div>
          
          <!-- Dropdown Messages -->
          <div *ngIf="message.type === 'dropdown'" class="dropdown-message">
            <p class="dropdown-label">{{ message.content }}</p>
            <nz-select 
              [nzPlaceHolder]="'ุงุฎุชุฑ ' + (message.data.fieldLabel || message.data.label || message.data.field)"
              (ngModelChange)="onDropdownSelection(message.data.field, $event)"
              style="width: 100%;">
              <nz-option 
                *ngFor="let option of message.data.options" 
                [nzValue]="option.value || option" 
                [nzLabel]="option.label || option">
              </nz-option>
            </nz-select>
          </div>
          
          <!-- Contact Form Messages -->
          <div *ngIf="message.type === 'contact-form'" class="contact-form-message">
            <p>{{ message.content }}</p>
            <button 
              nz-button 
              nzType="primary" 
              (click)="openContactForm()">
              <i nz-icon nzType="user-add" nzTheme="outline"></i>
              ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู
            </button>
          </div>
        </div>
      </div>

      <!-- Accumulated Files Panel -->
      <div class="accumulated-files-panel" *ngIf="showAccumulatedFiles">
        <div class="panel-header">
          <h4>ุงููููุงุช ุงููุญุฏุฏุฉ / Selected Files</h4>
          <button nz-button nzType="text" nzSize="small" (click)="clearAccumulatedFiles()">
            <i nz-icon nzType="delete" nzTheme="outline"></i>
          </button>
        </div>
        <div class="files-list">
          <div *ngFor="let file of accumulatedFiles; let i = index" class="file-item">
            <span>{{ file.name }}</span>
            <button nz-button nzType="text" nzSize="small" (click)="removeAccumulatedFile(i)">
              <i nz-icon nzType="close" nzTheme="outline"></i>
            </button>
          </div>
        </div>
        <div class="panel-footer">
          <button nz-button nzType="default" (click)="clearAccumulatedFiles()">
            ุฅูุบุงุก / Cancel
          </button>
          <button nz-button nzType="primary" (click)="proceedWithAccumulatedFiles()">
            ูุชุงุจุนุฉ / Continue
          </button>
        </div>
      </div>
    </div>

    <!-- Chat Footer -->
    <div class="chat-footer">
      <!-- Inline fallback quick actions if message rendering fails -->
      <div class="inline-quick-actions" *ngIf="showInlineQuickActions">
        <button class="action-btn" (click)="onButtonClick('upload')">๐ ุฑูุน ูุณุชูุฏ / Upload Document</button>
        <button class="action-btn" (click)="onButtonClick('manual')">โ๏ธ ุฅุฏุฎุงู ูุฏูู / Manual Entry</button>
        <button class="action-btn" (click)="onButtonClick('help')">โ ูุณุงุนุฏุฉ / Help</button>
      </div>
      
      <!-- Debug info for inline actions -->
      <div *ngIf="showInlineQuickActions" style="font-size: 10px; color: #666; margin-bottom: 5px;">
        Debug: Inline quick actions enabled ({{ showInlineQuickActions }})
      </div>
      <div class="input-container">
        <input 
          type="file" 
          id="file-upload"
          multiple 
          accept="image/*" 
          (change)="onFileSelected($event)"
          style="display: none;">
        
        <button 
          class="attach-btn" 
          (click)="onButtonClick('upload')"
          nz-tooltip
          nzTooltipTitle="ุฑูุน ูุณุชูุฏุงุช / Upload Documents"
          nzTooltipPlacement="top">
          <span aria-hidden="true">๐</span>
          <span *ngIf="accumulatedFiles.length > 0" class="file-count">{{ accumulatedFiles.length }}</span>
        </button>
        
        <input 
          id="chat-message-input"
          name="chat-message-input"
          type="text" 
          [(ngModel)]="newMessage" 
          (keydown)="onEnterKey($event)"
          placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง... / Type your message here..."
          [disabled]="loading"
          aria-label="ุงูุชุจ ุฑุณุงูุชู ููุง / Type your message here">
        
        <button 
          class="send-btn" 
          (click)="sendMessage()"
          [disabled]="!newMessage.trim() || loading"
          nz-tooltip
          nzTooltipTitle="ุฅุฑุณุงู / Send"
          nzTooltipPlacement="top">
          <span aria-hidden="true">โค</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Document Upload Modal Template -->
<ng-template #documentModalTemplate>
  <div class="document-modal-content">
    <!-- Debug info -->
    <div style="background: #f0f0f0; padding: 10px; margin-bottom: 10px; font-size: 12px;">
      Debug: documentsFA.length = {{ documentsFA.length }}, pendingFiles.length = {{ pendingFiles.length }}
    </div>
    
    <form [formGroup]="documentMetadataForm">
      <div formArrayName="documents">
        <!-- Show message if no documents -->
        <div *ngIf="documentsFA.length === 0" style="text-align: center; padding: 20px; color: #666;">
          <p>ูุง ุชูุฌุฏ ูุณุชูุฏุงุช ููุนุฑุถ / No documents to display</p>
          <p>pendingFiles: {{ pendingFiles.length }}</p>
        </div>
        
        <div 
          *ngFor="let docGroup of documentsFA.controls; let i = index" 
          [formGroupName]="i" 
          class="document-form">
          
          <nz-card [nzTitle]="'ูุณุชูุฏ ' + (i + 1)" nzSize="small">
            <div class="form-row">
              <div class="form-group">
                <label [for]="'fileName_' + i">ุงุณู ุงูููู / File Name:</label>
                <input 
                  [id]="'fileName_' + i"
                  [name]="'fileName_' + i"
                  formControlName="name" 
                  readonly
                  aria-label="ุงุณู ุงูููู / File Name">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label [for]="'country_' + i">ุงูุจูุฏ / Country:</label>
                <nz-select 
                  [id]="'country_' + i"
                  formControlName="country" 
                  (ngModelChange)="onCountryChange($event, i)"
                  aria-label="ุงูุจูุฏ / Country">
                  <nz-option 
                    *ngFor="let country of countriesList" 
                    [nzValue]="country" 
                    [nzLabel]="country">
                  </nz-option>
                </nz-select>
              </div>
              
              <div class="form-group">
                <label [for]="'documentType_' + i">ููุน ุงููุณุชูุฏ / Document Type:</label>
                <nz-select 
                  [id]="'documentType_' + i"
                  formControlName="type"
                  aria-label="ููุน ุงููุณุชูุฏ / Document Type">
                  <nz-option 
                    *ngFor="let type of getDocumentTypesByCountry(docGroup.get('country')?.value || '')" 
                    [nzValue]="type" 
                    [nzLabel]="type">
                  </nz-option>
                </nz-select>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group full-width">
                <label [for]="'description_' + i">ุงููุตู / Description:</label>
                <textarea 
                  [id]="'description_' + i"
                  [name]="'description_' + i"
                  formControlName="description" 
                  rows="2"
                  aria-label="ุงููุตู / Description"></textarea>
              </div>
            </div>
          </nz-card>
        </div>
      </div>
    </form>
    
    <div class="modal-footer">
      <button nz-button nzType="default" (click)="closeDocumentModal()">
        ุฅูุบุงุก / Cancel
      </button>
      <button nz-button nzType="primary" (click)="saveDocuments()" [disabled]="!isDocumentFormValid">
        ุญูุธ ููุชุงุจุนุฉ / Save & Continue
      </button>
    </div>
  </div>
</ng-template>

<!-- Hidden file input for programmatic uploads (used by quick actions) -->
<input 
  type="file" 
  id="file-upload"
  style="display: none"
  multiple
  accept="image/*"
  (change)="onFileSelected($event)">

<!-- Contact Form Modal -->
<nz-modal 
  [(nzVisible)]="showContactForm" 
  nzTitle="ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู / Add Contact"
  (nzOnCancel)="closeContactForm()"
  [nzFooter]="null"
  nzWidth="600px">
  
  <form [formGroup]="contactForm">
    <div class="contact-form-content">
      <div class="form-row">
        <div class="form-group">
          <label>ุงูุงุณู / Name: *</label>
          <input formControlName="name" placeholder="ุฃุฏุฎู ุงูุงุณู ุงููุงูู">
        </div>
        <div class="form-group">
          <label>ุงููุณูู ุงููุธููู / Job Title: *</label>
          <input formControlName="jobTitle" placeholder="ุฃุฏุฎู ุงููุณูู ุงููุธููู">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู / Email: *</label>
          <input formControlName="email" type="email" placeholder="example@company.com">
        </div>
        <div class="form-group">
          <label>ุงูุฌูุงู / Mobile: *</label>
          <input formControlName="mobile" placeholder="+966501234567">
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label>ุงููุงุชู ุงูุฃุฑุถู / Landline:</label>
          <input formControlName="landline" placeholder="+966112345678">
        </div>
        <div class="form-group">
          <label>ุงููุบุฉ ุงูููุถูุฉ / Preferred Language:</label>
          <nz-select formControlName="preferredLanguage">
            <nz-option nzValue="Arabic" nzLabel="ุงูุนุฑุจูุฉ"></nz-option>
            <nz-option nzValue="English" nzLabel="English"></nz-option>
          </nz-select>
        </div>
      </div>
    </div>
  </form>
  
  <div class="modal-footer">
    <button nz-button nzType="default" (click)="closeContactForm()">
      ุฅูุบุงุก / Cancel
    </button>
    <button nz-button nzType="primary" (click)="saveContactForm()" [disabled]="!contactForm.valid">
      ุญูุธ / Save
    </button>
  </div>
</nz-modal>

<!-- Edit Form Modal -->
<nz-modal 
  [(nzVisible)]="showEditForm" 
  nzTitle="ุชุนุฏูู ุงูุจูุงูุงุช ุงููุณุชุฎุฑุฌุฉ / Edit Extracted Data"
  (nzOnCancel)="closeEditForm()"
  [nzFooter]="null"
  nzWidth="700px"
  [nzMaskClosable]="false"
  [nzClosable]="true">
  
  <!-- โ ุชุฃูุฏ ูู ูุฌูุฏ *ngIf ุตุญ -->
  <div *nzModalContent>
    <form *ngIf="editForm" [formGroup]="editForm">
      <div class="edit-form-content">
      <!-- Company Information -->
      <div class="form-section">
        <h4>ูุนูููุงุช ุงูุดุฑูุฉ / Company Information</h4>
        <div class="form-row">
          <div class="form-group">
            <label>ุงุณู ุงูุดุฑูุฉ (ุฅูุฌููุฒู) / Company Name (English): <span class="required">*</span></label>
            <input formControlName="firstName" placeholder="Company Name">
          </div>
          <div class="form-group">
            <label>ุงุณู ุงูุดุฑูุฉ (ุนุฑุจู) / Company Name (Arabic): <span class="required">*</span></label>
            <input formControlName="firstNameAR" placeholder="ุงุณู ุงูุดุฑูุฉ">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>ุงูุฑูู ุงูุถุฑูุจู / Tax Number: <span class="required">*</span></label>
            <input formControlName="tax" placeholder="Tax Number">
          </div>
          <div class="form-group">
            <label>ููุน ุงูุนููู / Customer Type: <span class="required">*</span></label>
            <nz-select formControlName="CustomerType">
              <nz-option nzValue="Corporate" nzLabel="Corporate"></nz-option>
              <nz-option nzValue="SME" nzLabel="SME"></nz-option>
              <nz-option nzValue="Individual" nzLabel="Individual"></nz-option>
            </nz-select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>ุงุณู ุงููุงูู / Owner Name:</label>
            <input formControlName="ownerName" placeholder="Owner Name">
          </div>
        </div>
      </div>

      <!-- Address Information -->
      <div class="form-section">
        <h4>ูุนูููุงุช ุงูุนููุงู / Address Information</h4>
        <div class="form-row">
          <div class="form-group">
            <label>ุฑูู ุงููุจูู / Building Number:</label>
            <input formControlName="buildingNumber" placeholder="Building Number">
          </div>
          <div class="form-group">
            <label>ุงูุดุงุฑุน / Street:</label>
            <input formControlName="street" placeholder="Street Address">
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>ุงูุฏููุฉ / Country:</label>
            <nz-select formControlName="country">
              <nz-option nzValue="Egypt" nzLabel="Egypt"></nz-option>
              <nz-option nzValue="Saudi Arabia" nzLabel="Saudi Arabia"></nz-option>
              <nz-option nzValue="United Arab Emirates" nzLabel="United Arab Emirates"></nz-option>
              <nz-option nzValue="Yemen" nzLabel="Yemen"></nz-option>
            </nz-select>
          </div>
          <div class="form-group">
            <label>ุงููุฏููุฉ / City:</label>
            <input formControlName="city" placeholder="City">
          </div>
        </div>
      </div>

      <!-- Sales Information -->
      <div class="form-section">
        <h4>ูุนูููุงุช ุงููุจูุนุงุช / Sales Information</h4>
        <div class="form-row">
          <div class="form-group">
            <label>ููุธูุฉ ุงููุจูุนุงุช / Sales Organization: <span class="required">*</span></label>
            <nz-select formControlName="salesOrganization">
              <nz-option nzValue="egypt_cairo_office" nzLabel="Egypt - Cairo Head Office"></nz-option>
              <nz-option nzValue="egypt_alexandria_branch" nzLabel="Egypt - Alexandria Branch"></nz-option>
              <nz-option nzValue="egypt_giza_branch" nzLabel="Egypt - Giza Branch"></nz-option>
              <nz-option nzValue="ksa_riyadh_office" nzLabel="Saudi Arabia - Riyadh Office"></nz-option>
              <nz-option nzValue="ksa_jeddah_branch" nzLabel="Saudi Arabia - Jeddah Branch"></nz-option>
            </nz-select>
          </div>
          <div class="form-group">
            <label>ููุงุฉ ุงูุชูุฒูุน / Distribution Channel: <span class="required">*</span></label>
            <nz-select formControlName="distributionChannel">
              <nz-option nzValue="direct_sales" nzLabel="Direct Sales"></nz-option>
              <nz-option nzValue="authorized_distributors" nzLabel="Authorized Distributors"></nz-option>
              <nz-option nzValue="retail_chains" nzLabel="Retail Chains"></nz-option>
            </nz-select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label>ุงููุณู / Division: <span class="required">*</span></label>
            <nz-select formControlName="division">
              <nz-option nzValue="food_products" nzLabel="Food Products Division"></nz-option>
              <nz-option nzValue="beverages" nzLabel="Beverages Division"></nz-option>
              <nz-option nzValue="household_items" nzLabel="Household Items Division"></nz-option>
            </nz-select>
          </div>
        </div>
        </div>
      </div>
    </form>
    
    <!-- โ Footer buttons -->
    <div class="modal-footer">
      <button nz-button nzType="default" (click)="closeEditForm()">
        ุฅูุบุงุก / Cancel
      </button>
      <button nz-button nzType="primary" (click)="saveEditForm()">
        ุญูุธ ุงูุชุนุฏููุงุช / Save Changes
      </button>
    </div>
  </div>
</nz-modal>

<!-- Missing Fields Form Modal -->
<nz-modal 
  [(nzVisible)]="showMissingFieldsForm" 
  nzTitle="ุฅููุงู ุงูุจูุงูุงุช ุงููุงูุตุฉ / Complete Missing Data"
  (nzOnCancel)="closeMissingFieldsForm()"
  [nzFooter]="null"
  nzWidth="700px"
  [nzMaskClosable]="false"
  [nzClosable]="true">
  
  <div *nzModalContent>
    <form *ngIf="missingFieldsForm" [formGroup]="missingFieldsForm">
      <div class="edit-form-content">
        <!-- Company Information -->
        <div class="form-section">
          <h4>ูุนูููุงุช ุงูุดุฑูุฉ / Company Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>ุงุณู ุงูุดุฑูุฉ (ุฅูุฌููุฒู) / Company Name (English): <span class="required">*</span></label>
              <input formControlName="firstName" placeholder="Company Name" [readonly]="!currentMissingFields.includes('firstName')">
            </div>
            <div class="form-group">
              <label>ุงุณู ุงูุดุฑูุฉ (ุนุฑุจู) / Company Name (Arabic): <span class="required">*</span></label>
              <input formControlName="firstNameAR" placeholder="ุงุณู ุงูุดุฑูุฉ" [readonly]="!currentMissingFields.includes('firstNameAR')">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ุงูุฑูู ุงูุถุฑูุจู / Tax Number: <span class="required">*</span></label>
              <input formControlName="tax" placeholder="Tax Number" [readonly]="!currentMissingFields.includes('tax')">
            </div>
            <div class="form-group">
              <label>ููุน ุงูุนููู / Customer Type: <span class="required">*</span></label>
              <nz-select formControlName="CustomerType" [nzDisabled]="!currentMissingFields.includes('CustomerType')">
                <nz-option nzValue="Corporate" nzLabel="Corporate"></nz-option>
                <nz-option nzValue="SME" nzLabel="SME"></nz-option>
                <nz-option nzValue="Individual" nzLabel="Individual"></nz-option>
              </nz-select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ุงุณู ุงููุงูู / Owner Name:</label>
              <input formControlName="ownerName" placeholder="Owner Name" [readonly]="!currentMissingFields.includes('ownerName')">
            </div>
          </div>
        </div>

        <!-- Address Information -->
        <div class="form-section">
          <h4>ูุนูููุงุช ุงูุนููุงู / Address Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>ุฑูู ุงููุจูู / Building Number:</label>
              <input formControlName="buildingNumber" placeholder="Building Number" [readonly]="!currentMissingFields.includes('buildingNumber')">
            </div>
            <div class="form-group">
              <label>ุงูุดุงุฑุน / Street:</label>
              <input formControlName="street" placeholder="Street Name" [readonly]="!currentMissingFields.includes('street')">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ุงูุฏููุฉ / Country: <span class="required">*</span></label>
              <nz-select formControlName="country" [nzDisabled]="!currentMissingFields.includes('country')">
                <nz-option nzValue="Egypt" nzLabel="Egypt"></nz-option>
                <nz-option nzValue="Saudi Arabia" nzLabel="Saudi Arabia"></nz-option>
                <nz-option nzValue="United Arab Emirates" nzLabel="United Arab Emirates"></nz-option>
                <nz-option nzValue="Yemen" nzLabel="Yemen"></nz-option>
              </nz-select>
            </div>
            <div class="form-group">
              <label>ุงููุฏููุฉ / City:</label>
              <input formControlName="city" placeholder="City" [readonly]="!currentMissingFields.includes('city')">
            </div>
          </div>
        </div>

        <!-- Sales Information -->
        <div class="form-section">
          <h4>ูุนูููุงุช ุงููุจูุนุงุช / Sales Information</h4>
          <div class="form-row">
            <div class="form-group">
              <label>ููุธูุฉ ุงููุจูุนุงุช / Sales Organization: <span class="required">*</span></label>
              <nz-select formControlName="salesOrganization" [nzDisabled]="!currentMissingFields.includes('salesOrganization')">
                <nz-option nzValue="egypt_cairo_office" nzLabel="Egypt - Cairo Head Office"></nz-option>
                <nz-option nzValue="egypt_alexandria_branch" nzLabel="Egypt - Alexandria Branch"></nz-option>
                <nz-option nzValue="egypt_giza_branch" nzLabel="Egypt - Giza Branch"></nz-option>
                <nz-option nzValue="ksa_riyadh_office" nzLabel="Saudi Arabia - Riyadh Office"></nz-option>
                <nz-option nzValue="ksa_jeddah_branch" nzLabel="Saudi Arabia - Jeddah Branch"></nz-option>
              </nz-select>
            </div>
            <div class="form-group">
              <label>ููุงุฉ ุงูุชูุฒูุน / Distribution Channel: <span class="required">*</span></label>
              <nz-select formControlName="distributionChannel" [nzDisabled]="!currentMissingFields.includes('distributionChannel')">
                <nz-option nzValue="direct_sales" nzLabel="Direct Sales"></nz-option>
                <nz-option nzValue="authorized_distributors" nzLabel="Authorized Distributors"></nz-option>
                <nz-option nzValue="retail_chains" nzLabel="Retail Chains"></nz-option>
              </nz-select>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>ุงููุณู / Division: <span class="required">*</span></label>
              <nz-select formControlName="division" [nzDisabled]="!currentMissingFields.includes('division')">
                <nz-option nzValue="food_products" nzLabel="Food Products Division"></nz-option>
                <nz-option nzValue="beverages" nzLabel="Beverages Division"></nz-option>
                <nz-option nzValue="household_items" nzLabel="Household Items Division"></nz-option>
              </nz-select>
            </div>
          </div>
        </div>
      </div>
    </form>
    
    <div class="modal-footer">
      <button nz-button nzType="default" (click)="closeMissingFieldsForm()">
        ุฅูุบุงุก / Cancel
      </button>
      <button nz-button nzType="primary" (click)="saveMissingFieldsForm()">
        ุญูุธ ุงูุจูุงูุงุช ุงููุงูุตุฉ / Save Missing Data
      </button>
    </div>
  </div>
</nz-modal>

<!-- Uploaded Documents Display -->
<div *ngIf="getUploadedDocuments().length > 0" class="uploaded-documents">
  <h4>ุงููุณุชูุฏุงุช ุงููุฑููุนุฉ / Uploaded Documents</h4>
  <div class="documents-grid">
    <div *ngFor="let doc of getUploadedDocuments(); let i = index" class="document-card">
      <div class="document-info">
        <h5>{{ doc.name }}</h5>
        <p>{{ doc.type }} - {{ (doc.size / 1024).toFixed(2) }}KB</p>
      </div>
      <button 
        nz-button 
        nzType="text" 
        nzDanger 
        (click)="removeDocument(i)">
        <i nz-icon nzType="delete" nzTheme="outline"></i>
      </button>
    </div>
  </div>
</div>
