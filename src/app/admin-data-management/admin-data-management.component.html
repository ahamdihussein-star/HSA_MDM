<div class="data-management-page">
  
  <!-- Professional Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <button nz-button (click)="goBack()" class="back-btn">
          <span nz-icon nzType="arrow-left"></span>
          Back to Dashboard
        </button>
      </div>
      <div class="header-center">
        <div class="title-section">
          <div class="title-icon">
            <span nz-icon nzType="database"></span>
          </div>
          <div class="title-text">
            <h1>Data Management Center</h1>
            <p>Manage and monitor your master data records</p>
          </div>
        </div>
      </div>
      <div class="header-right">
        <button nz-button nzType="primary" (click)="loadStats()" [nzLoading]="loading" class="refresh-btn">
          <span nz-icon nzType="reload"></span>
          Refresh Data
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Spinner -->
  <nz-spin [nzSpinning]="loading" nzTip="Loading data statistics...">
    
    <!-- Professional Statistics Dashboard -->
    <div class="stats-dashboard">
      <div class="dashboard-header">
        <h2>
          <span class="dashboard-icon">ðŸ“Š</span>
          Data Statistics Overview
        </h2>
        <div class="last-updated">
          Last updated: {{ getFormattedTime() }}
        </div>
      </div>

      <div nz-row [nzGutter]="[20, 20]" class="stats-grid">
        
        <!-- Duplicate Records Card -->
        <div nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
          <div class="stat-card duplicate-card">
            <div class="stat-header">
              <div class="stat-icon duplicate-icon">
                <span nz-icon nzType="copy"></span>
              </div>
              <div class="stat-actions">
                <button nz-button nzSize="small" nzType="link" nzDanger 
                        (click)="clearSpecificData('duplicates')"
                        [disabled]="stats.duplicateRecords === 0"
                        [title]="'Clear all duplicate records'">
                  <span nz-icon nzType="delete"></span>
                </button>
              </div>
            </div>
            <div class="stat-content">
              <div class="stat-number">{{ formatNumber(stats.duplicateRecords) }}</div>
              <div class="stat-label">Duplicate Records</div>
              <div class="stat-description">Records identified as duplicates</div>
            </div>
            <div class="stat-footer">
              <span class="stat-status" [class]="getStatusClass(stats.duplicateRecords)">
                {{ getStatusText(stats.duplicateRecords, 'duplicates') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Quarantine Records Card -->
        <div nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
          <div class="stat-card quarantine-card">
            <div class="stat-header">
              <div class="stat-icon quarantine-icon">
                <span nz-icon nzType="warning"></span>
              </div>
              <div class="stat-actions">
                <button nz-button nzSize="small" nzType="link" nzDanger 
                        (click)="clearSpecificData('quarantine')"
                        [disabled]="stats.quarantineRecords === 0"
                        [title]="'Clear all quarantine records'">
                  <span nz-icon nzType="delete"></span>
                </button>
              </div>
            </div>
            <div class="stat-content">
              <div class="stat-number">{{ formatNumber(stats.quarantineRecords) }}</div>
              <div class="stat-label">Quarantine Records</div>
              <div class="stat-description">Records requiring review</div>
            </div>
            <div class="stat-footer">
              <span class="stat-status" [class]="getStatusClass(stats.quarantineRecords)">
                {{ getStatusText(stats.quarantineRecords, 'quarantine') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Golden Records Card -->
        <div nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
          <div class="stat-card golden-card">
            <div class="stat-header">
              <div class="stat-icon golden-icon">
                <span nz-icon nzType="star"></span>
              </div>
              <div class="stat-actions">
                <button nz-button nzSize="small" nzType="link" nzDanger 
                        (click)="clearSpecificData('golden')"
                        [disabled]="stats.goldenRecords === 0"
                        [title]="'Clear all golden records'">
                  <span nz-icon nzType="delete"></span>
                </button>
              </div>
            </div>
            <div class="stat-content">
              <div class="stat-number">{{ formatNumber(stats.goldenRecords) }}</div>
              <div class="stat-label">Golden Records</div>
              <div class="stat-description">Master approved records</div>
            </div>
            <div class="stat-footer">
              <span class="stat-status" [class]="getStatusClass(stats.goldenRecords)">
                {{ getStatusText(stats.goldenRecords, 'golden') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Total Requests Card -->
        <div nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
          <div class="stat-card requests-card">
            <div class="stat-header">
              <div class="stat-icon requests-icon">
                <span nz-icon nzType="file-text"></span>
              </div>
              <div class="stat-actions">
                <button nz-button nzSize="small" nzType="link" nzDanger 
                        (click)="clearSpecificData('requests')"
                        [disabled]="stats.totalRequests === 0"
                        [title]="'Clear all requests'">
                  <span nz-icon nzType="delete"></span>
                </button>
              </div>
            </div>
            <div class="stat-content">
              <div class="stat-number">{{ formatNumber(stats.totalRequests) }}</div>
              <div class="stat-label">Total Requests</div>
              <div class="stat-description">All system requests</div>
            </div>
            <div class="stat-footer">
              <span class="stat-status" [class]="getStatusClass(stats.totalRequests)">
                {{ getStatusText(stats.totalRequests, 'requests') }}
              </span>
            </div>
          </div>
        </div>

        <!-- Pending Requests Card (Additional) -->
        <div nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
          <div class="stat-card pending-card">
            <div class="stat-header">
              <div class="stat-icon pending-icon">
                <span nz-icon nzType="clock-circle"></span>
              </div>
              <div class="stat-actions">
                <span class="stat-badge">{{ getPendingPercentage() }}%</span>
              </div>
            </div>
            <div class="stat-content">
              <div class="stat-number">{{ formatNumber(stats.pendingRequests) }}</div>
              <div class="stat-label">Pending Requests</div>
              <div class="stat-description">Awaiting processing</div>
            </div>
            <div class="stat-footer">
              <span class="stat-status" [class]="getStatusClass(stats.pendingRequests)">
                {{ getStatusText(stats.pendingRequests, 'pending') }}
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Generate Test Data Section -->
    <div class="generate-data-section" style="margin-top: 30px;">
      <nz-card>
        <h2>
          <span nz-icon nzType="experiment" style="color: #1890ff;"></span>
          Generate Test Data
        </h2>
        
        <nz-alert
          nzType="info"
          nzMessage="Test Data Generation"
          nzDescription="Generate sample data for testing quarantine and duplicate record workflows"
          nzShowIcon
          style="margin-bottom: 20px;">
        </nz-alert>

        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
          <button nz-button nzType="primary" nzSize="large"
                  (click)="generateQuarantineData()" 
                  [nzLoading]="loading">
            <span nz-icon nzType="plus-circle"></span>
            Generate Quarantine Data
          </button>
          
          <button nz-button nzType="primary" nzSize="large"
                  (click)="generateDuplicateData()" 
                  [nzLoading]="loading">
            <span nz-icon nzType="copy"></span>
            Generate Duplicate Data
          </button>
        </div>
        
        <p style="margin-top: 15px; color: #8c8c8c; font-size: 13px;">
          <span nz-icon nzType="info-circle"></span>
          This will create sample records for testing purposes.
        </p>
      </nz-card>
    </div>

    <!-- Danger Zone -->
    <div class="danger-zone" style="margin-top: 30px;">
      <nz-card style="border: 2px solid #ffccc7;">
        <h2>
          <span nz-icon nzType="warning" nzTheme="twotone" [nzTwotoneColor]="'#ff4d4f'"></span>
          Danger Zone
        </h2>
        
        <nz-alert
          nzType="warning"
          nzMessage="Warning"
          nzDescription="These actions are permanent and cannot be undone!"
          nzShowIcon
          style="margin-bottom: 20px;">
        </nz-alert>

        <div class="danger-actions">
          <button nz-button nzType="primary" nzDanger nzSize="large"
                  (click)="openConfirmModal()"
                  [disabled]="loading">
            <span nz-icon nzType="delete"></span>
            Clear All Data
          </button>
          
          <p class="danger-note" style="margin-top: 15px; color: #8c8c8c;">
            This will delete all records, requests, and related data.<br>
            User accounts will be preserved.
          </p>
        </div>
      </nz-card>
    </div>

  </nz-spin>
</div>