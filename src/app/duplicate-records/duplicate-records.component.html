  <div class="titleActionHolder">
    <h1 class="pageTitle">
      {{ "DuplicateRecords" | translate }} ({{ duplicateRecords.length }} {{ "Groups" | translate }})
    </h1>

  <div class="actionHolderTitleTabs">
    <div class="seachInputHolder">
      <img src="./assets/img/search.svg" alt="" />
      <input 
        type="text" 
        [placeholder]="'Search' | translate" 
        [(ngModel)]="searchTerm"
        (input)="onSearchChange($event)"
      />
    </div>
    <div class="filterHolder">
      <select 
        [(ngModel)]="filterBySource" 
        (change)="onFilterChange($event)"
        class="filter-select"
      >
        <option value="">{{ 'All Sources' | translate }}</option>
        <option *ngFor="let source of getUniqueSourceSystems()" [value]="source">
          {{ source }}
        </option>
      </select>
      <button 
        *ngIf="searchTerm || filterBySource" 
        (click)="clearFilters()" 
        class="clear-filters-btn"
        title="Clear filters"
      >
        âœ•
      </button>
    </div>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="text-center p-4">
  <div class="loading">{{ 'Loading duplicate records...' | translate }}</div>
</div>

<!-- TABLE -->
<div *ngIf="!loading">
  <nz-table #customerTable [nzPageSize]="9" [nzData]="filteredRecords">
    <thead>
      <tr>
        <th>{{ 'Tax Number' | translate }}</th>
        <th>{{ 'Company Name' | translate }}</th>
        <th>{{ 'Source Systems' | translate }}</th>
        <th>{{ 'Suspected Duplicates' | translate }}</th>
        <th>{{ 'Action' | translate }}</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let data of customerTable.data">
        <td>
          <span class="mono">{{ data.tax }}</span>
        </td>
        <td>
          <div class="primary-name">{{ getPrimaryCompanyName(data) }}</div>
          <div class="other-names" *ngIf="getOtherCompanyNames(data)">
            <small class="text-muted">Also: {{ getOtherCompanyNames(data) }}</small>
          </div>
        </td>
        <td>
          <ul class="source-systems-list">
            <li *ngFor="let system of data.sourceSystems">{{ system }}</li>
          </ul>
        </td>
        <td>
          <span class="duplicate-count">{{ data.duplicateCount }} {{ 'records' | translate }}</span>
        </td>
        <td>
          <a class="primaryColor" 
             style="cursor: pointer; text-decoration: underline; color: #1890ff;"
             (click)="viewDetails(data)">
            {{ "ViewDetails" | translate }}
          </a>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>

<!-- Empty State -->
<div *ngIf="!loading && duplicateRecords.length === 0" class="empty-state text-center p-5">
  <h3>{{ 'No Duplicate Records Found' | translate }}</h3>
  <p>{{ 'All records have been processed or there are no duplicates to review' | translate }}</p>
</div>

<!-- No Search Results -->
<div *ngIf="!loading && duplicateRecords.length > 0 && filteredRecords.length === 0" class="empty-state text-center p-5">
  <h3>{{ 'No Results Found' | translate }}</h3>
  <p>{{ 'No records match your search criteria. Try adjusting your search or filters.' | translate }}</p>
  <button (click)="clearFilters()" class="btn btn-primary">{{ 'Clear Filters' | translate }}</button>
</div>

<style>
  .mono {
    font-family: monospace;
    font-size: 12px;
  }
  
  .primary-name {
    font-weight: 500;
  }
  
  .other-names {
    margin-top: 2px;
  }
  
  .badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 11px;
  }
  
  .badge-primary {
    background: #007bff;
    color: white;
  }
  
  .badge-info {
    background: #17a2b8;
    color: white;
  }
  
  .badge-danger {
    background: #dc3545;
    color: white;
  }
  
  .badge-warning {
    background: #ffc107;
    color: black;
  }
  
  .badge-default {
    background: #6c757d;
    color: white;
  }
  
  .empty-state {
    background: #f8f9fa;
    border-radius: 8px;
    margin: 20px;
  }
  
  .primaryColor:hover {
    text-decoration: underline !important;
    opacity: 0.8;
  }

  .filterHolder {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .filter-select {
    background-color: white;
    border: 1px solid #d9d9d9;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 14px;
    min-width: 150px;
    cursor: pointer;
  }

  .filter-select:focus {
    border-color: #1890ff;
    outline: none;
  }

  .clear-filters-btn {
    background: #ff4d4f;
    color: white;
    border: none;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 12px;
    font-weight: bold;
  }

  .clear-filters-btn:hover {
    background: #ff7875;
  }

  .btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
  }

  .btn-primary {
    background: #1890ff;
    color: white;
  }

  .btn-primary:hover {
    background: #40a9ff;
  }
</style>